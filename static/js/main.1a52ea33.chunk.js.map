{"version":3,"sources":["components/FileInput.tsx","Logic/parseCSV.ts","components/common-components.tsx","components/visualize/DayUnit.tsx","components/Calendar.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["FileInput","setInputFile","onUploadImage","useCallback","e","currentTarget","files","style","background","padding","margin","type","accept","onChange","createDuration","cols","split","length","hours","parseInt","minutes","OuterContainer","styled","div","Title","h1","Message","Date","Frame","Days","DayUnit","duration","DayComponent","toFormat","props","durationHeight","durationColor","durationNum","Calendar","calendar","flat","map","col","undefined","endTime","setLocale","display","flexDirection","alignItems","Unit","color","sleepTime","goodQuality","deepSleep","toString","substring","replace","App","useState","inputFile","readCSV","setReadCSV","useEffect","reader","FileReader","onload","result","readAsText","csvString","origin","shift","pop","rows","line","startTime","DateTime","fromFormat","Duration","fromObject","wakingInBed","timeToSleep","heartRate","tag","annotation","dateMappedRows","reduce","obj","data","initDateTime","weekday","startOf","minus","days","durationDays","endOf","diff","weekNum","i","date","plus","push","console","table","parseCSV","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1a52ea33.chunk.js","sourcesContent":["import { useCallback } from \"react\";\n\nexport interface IInputFile {\n  setInputFile: React.Dispatch<React.SetStateAction<File | undefined>>;\n}\n\nexport const FileInput = ({ setInputFile }: IInputFile) => {\n  const onUploadImage = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      if (e.currentTarget.files !== null) {\n        setInputFile(e.currentTarget.files[0]);\n      }\n    },\n    [setInputFile]\n  );\n\n  return (\n    // <>\n    <div style={{ background: \"#FFFFFFDD\", padding: \"4px\", margin: \"8px\" }}>\n      <input type=\"file\" accept=\"text\" onChange={onUploadImage} />\n    </div>\n    // </>\n  );\n};\n","import { DateTime, Duration } from \"luxon\";\n\nexport const parseCSV = (csvString: string) => {\n  // 初期状態．CSVが読み込まれる前\n  if (csvString === \"\") {\n    return false;\n  }\n  const origin = csvString.split(\"\\r\\n\");\n  // 先頭の行を削除\n  origin.shift();\n  // 末尾の行を削除\n  origin.pop();\n\n  const rows: ICol[] = origin.map((line) => {\n    const col = line.split(\",\");\n    return {\n      startTime: DateTime.fromFormat(col[0], \"yyyy-MM-dd HH:mm:ss\"),\n      endTime: DateTime.fromFormat(col[1], \"yyyy-MM-dd HH:mm:ss\"),\n      duration: Duration.fromObject(createDuration(col[2])),\n      sleepTime: Duration.fromObject(createDuration(col[3])),\n      wakingInBed: Duration.fromObject(createDuration(col[4])),\n      timeToSleep: Duration.fromObject(createDuration(col[5])),\n      goodQuality: Duration.fromObject(createDuration(col[6])),\n      deepSleep: Duration.fromObject(createDuration(col[7])),\n      heartRate: parseInt(col[8]),\n      tag: col[9],\n      annotation: col[10],\n    };\n  });\n\n  interface IDateMappedRow {\n    [key: string]: ICol;\n  }\n\n  const dateMappedRows: IDateMappedRow = rows.reduce(\n    (obj, data) => ({\n      ...obj,\n      [data.endTime.toFormat(\"yyyy-MM-dd-EEE\")]: data,\n    }),\n    {}\n  );\n\n  const initDateTime: DateTime =\n    rows[0].endTime.weekday !== 7\n      ? rows[0].endTime.startOf(\"week\").minus({ days: 1 })\n      : rows[0].endTime.startOf(\"day\");\n\n  const endDateTime: DateTime = rows[rows.length - 1].endTime\n    .endOf(\"week\")\n    .startOf(\"day\");\n\n  const durationDays = endDateTime.diff(initDateTime, \"days\").days;\n\n  const calendar: Array<Array<ICol | string>> = [];\n\n  let weekNum = 0;\n  for (let i = 0; i < durationDays; i++) {\n    const cnt = initDateTime.plus({ days: i });\n    const date = cnt.toFormat(\"yyyy-MM-dd-EEE\");\n    if (weekNum === calendar.length) {\n      calendar.push([]);\n    }\n\n    calendar[weekNum].push(dateMappedRows[date] ? dateMappedRows[date] : date);\n\n    if (i % 7 === 6) {\n      weekNum++;\n    }\n  }\n\n  console.table(calendar);\n  return calendar;\n};\n\nconst createDuration = (cols: string): { hours: number; minutes: number } => {\n  // 6:10 のような時:分の形式のとき\n  if (cols.split(\":\").length === 2) {\n    return {\n      hours: parseInt(cols.split(\":\")[0]),\n      minutes: parseInt(cols.split(\":\")[1]),\n    };\n  } else if (cols === \"--\") {\n    // \"--\"のとき とりあえず 0時間に設定\n    return {\n      hours: 0,\n      minutes: 0,\n    };\n  } else {\n    // 時間がない時 分へ\n    return {\n      hours: 0,\n      minutes: parseInt(cols),\n    };\n  }\n};\n\nexport interface ICol {\n  startTime: DateTime; //  睡眠開始時刻\n  endTime: DateTime; //  睡眠終了時刻\n  duration: Duration; //  Duration\n  sleepTime: Duration; //  睡眠時間\n  wakingInBed: Duration; //  ベッドで起きていた時間\n  timeToSleep: Duration; //  眠りにつくまでの時間\n  goodQuality: Duration; //  良質な睡眠\n  deepSleep: Duration; //  深い睡眠\n  heartRate: number; //  心拍数\n  tag: string; //  タグ\n  annotation: string; //  注釈\n}\n","import styled from \"styled-components\";\n\nexport const OuterContainer = styled.div`\n  margin-top: 2em;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-flow: column;\n`;\n\nexport const Title = styled.h1`\n  color: #ffffff;\n`;\n\nexport const Message = styled.div`\n  color: #ffffff;\n`;\n\nexport const Date = styled.div`\n  color: white;\n  margin-top: 2px;\n`;\n\nexport const Frame = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  flex-flow: column;\n  height: 100px;\n  border: 1px ridge #ffffff99;\n  background: linear-gradient(#08176d99, #01010799);\n  margin: 2px 1px;\n  border-radius: 4px;\n`;\n\nexport const Days = styled.div`\n  width: calc(208px * 7);\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: flex-end;\n`;\n","import { Duration } from \"luxon\";\nimport styled from \"styled-components\";\n\ninterface IDay {\n  duration: Duration | string;\n}\n\nexport const DayUnit = ({ duration }: IDay) => {\n  return (\n    <DayComponent duration={duration}>\n      {/* Duration | string のため string でないとき Duration 型になるので， その場合は toFormat で文字列へ */}\n      {typeof duration !== \"string\" ? duration.toFormat(\"hh:mm\") : duration}\n    </DayComponent>\n  );\n};\n\ninterface IDayDesign {\n  duration: string;\n}\n\nconst DayComponent = styled.div<IDayDesign>`\n  display: flex;\n  -webkit-align-items: center;\n  align-items: center;\n  -webkit-justify-content: center;\n  justify-content: center;\n  border-radius: 4px;\n  height: ${(props) => durationHeight(props.duration)};\n  width: 60px;\n  margin: 4px;\n  color: white;\n  background: ${(props) => durationColor(props.duration)};\n` as any;\n\nconst durationColor = (duration: Duration | string) => {\n  const durationNum =\n    typeof duration === \"string\" ? parseInt(duration) : duration.hours;\n  if (durationNum >= 8) {\n    return \"#43a2e2dd\";\n  } else if (durationNum >= 6) {\n    return \"#54c454dd\";\n  } else if (durationNum >= 4) {\n    return \"#ac692bdd\";\n  } else if (durationNum >= 2) {\n    return \"#dd5100dd\";\n  } else if (durationNum >= 0) {\n    return \"#FF0000dd\";\n  } else {\n    return \"#5e5e5edd\";\n  }\n};\n\nconst durationHeight = (duration: Duration | string) => {\n  const durationNum =\n    typeof duration === \"string\" ? parseInt(duration) : duration.hours;\n  return `${durationNum * 1.5 + 20}px`;\n};\n","import styled from \"styled-components\";\nimport { ICol } from \"../Logic/parseCSV\";\nimport { Days, Date, Frame } from \"./common-components\";\nimport { DayUnit } from \"./visualize/DayUnit\";\n\nexport const Calendar = ({ calendar }: { calendar: (string | ICol)[][] }) => {\n  return (\n    <Days>\n      {calendar.flat().map((col: ICol | string) => {\n        if (typeof col !== \"string\" && col.endTime !== undefined) {\n          return (\n            <>\n              <Frame>\n                <Date>{col.endTime.setLocale(\"jp\").toFormat(\"MM/dd\")}</Date>\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexDirection: \"row\",\n                    alignItems: \"flex-end\",\n                  }}\n                >\n                  <Unit>\n                    <div style={{ color: \"white\" }}>Total</div>\n                    <DayUnit duration={col.sleepTime} />\n                  </Unit>\n                  <Unit>\n                    <div style={{ color: \"white\" }}>Good</div>\n                    <DayUnit duration={col.goodQuality} />\n                  </Unit>\n                  <Unit>\n                    <div style={{ color: \"white\" }}>Deep</div>\n                    <DayUnit duration={col.deepSleep} />\n                  </Unit>\n                </div>\n              </Frame>\n            </>\n          );\n        } else {\n          return (\n            <Frame>\n              <Date>{`${col\n                .toString()\n                .substring(5, 10)\n                .replace(\"-\", \"/\")}`}</Date>\n              <div\n                style={{\n                  display: \"flex\",\n                  flexDirection: \"row\",\n                }}\n              >\n                <DayUnit duration={\"\"} />\n                <DayUnit duration={\"\"} />\n                <DayUnit duration={\"\"} />\n              </div>\n            </Frame>\n          );\n        }\n      })}\n    </Days>\n  );\n};\n\nconst Unit = styled.div`\n  height: 70px;\n  display: flex;\n  flex-flow: column;\n  justify-content: space-between;\n  align-items: center;\n`;\n","import { useEffect, useState } from \"react\";\nimport { FileInput } from \"./components/FileInput\";\nimport { parseCSV } from \"./Logic/parseCSV\";\nimport { Message, OuterContainer, Title } from \"./components/common-components\";\nimport { DayOfWeek } from \"./components/DayOfWeek\";\nimport { Calendar } from \"./components/Calendar\";\n\nexport const App = () => {\n  const [inputFile, setInputFile] = useState<File | undefined>();\n  const [readCSV, setReadCSV] = useState<string>(\"\");\n\n  useEffect(() => {\n    if (inputFile) {\n      const reader = new FileReader();\n      reader.onload = () => setReadCSV(reader.result as string);\n      reader.readAsText(inputFile, \"UTF-8\");\n    }\n  }, [inputFile]);\n\n  const calendar = parseCSV(readCSV);\n\n  return (\n    <>\n      <OuterContainer>\n        <Title>Sleepvis</Title>\n        <Message>\n          AutosleepアプリのCSVを可視化するWebアプリです．\n          <br />\n          随時機能追加中です．現状は，睡眠時間の表示機能のみになります．\n          <br />\n          下のファイルを選択ボタンからエクスポートしたCSVファイルを選択してください．\n        </Message>\n        <FileInput setInputFile={setInputFile} />\n        {/* <DayOfWeek /> */}\n        {calendar && <Calendar calendar={calendar} />}\n      </OuterContainer>\n    </>\n  );\n};\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport { App } from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}